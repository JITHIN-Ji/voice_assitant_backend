# üè• Medical Audio Processor & NER Evaluation

A Streamlit-based application to **process medical audio **, generate structured SOAP summaries, evaluate NER (Named Entity Recognition) metrics, and create downloadable reports. The app also allows generating medicine plans and sending appointment emails with user consent.

---

## üìÇ Features

- Upload medical consultation audio files (`wav`, `mp3`, `m4a`, `flac`).
- Automatic transcription using Whisper models.
- Extract structured **SOAP sections** (Subjective, Objective, Assessment, Plan).
- Evaluate NER metrics if reference text is provided.
- Generate and download **Excel reports** and **JSON summaries**.
- Generate medicine plans and optionally send appointment emails.
- View metrics, raw summary, and transcript in interactive tabs.

---

## ‚öôÔ∏è Requirements

- Python 3.10+
- [Streamlit](https://streamlit.io/)
- `pydub`
- `faster-whisper`
- `numpy`
- `pandas`
- `openpyxl`
- Other dependencies as specified in `requirements.txt`.

### model configuration

1- **Whisper (medium.en)** for audio transcription  
    'pip install faster-whisper'

2- **Gemini 2.5 Flash** for SOAP analysis 
    'pip install google-generativeai'

3- **scispaCy (en_ner_bc5cdr_md)** for medical NER evaluation  
    'pip install scispacy'
    'python -m spacy download en_ner_bc5cdr_md'

4- **sendergrid** from email sending mechanisum
    'pip install sendgrid'


### üõ† Environment Variables

# Gemini API key for SOAP analysis
GEMINI_API_KEY=YOUR_GEMINI_API_KEY

# SendGrid API key for sending emails
SENDGRID_API_KEY=YOUR_SENDGRID_API_KEY

# Enable or disable email sending
EMAIL_ENABLED=true



### HOW TO Run


### 1. Clone the Repository
*git clone <your-repo-url>
*cd <repo-directory>

### 2. Install Dependencies
*pip install -r requirements.txt*

### 3. Run the Streamlit App
*streamlit run mainapp.py

### 4. Upload Audio File
*Supported formats: wav, mp3, m4a, flac
*Maximum file size: 200 MB*
*Drag and drop or browse to select your audio file

### 5. Optional Reference Text
*Enter reference medical text for NER evaluation in the text area
*If left empty, only summarization will be performed

### 6. Process Audio
*Click "üîÑ Process Audio" to start processing
The app will:

*Transcribe audio
*Extract SOAP sections
*Generate Excel and JSON reports
*Display metrics, summary, and transcript

### 7. View Results
*SOAP Sections ‚Äì displayed on the main page
*Metrics Tab ‚Äì evaluation metrics and entity extraction
*Raw Summary Tab ‚Äì full summary text
*Transcript Tab ‚Äì full audio transcription

### 8. Download Reports
*SOAP JSON ‚Äì structured summary of SOAP sections
*Excel Report ‚Äì includes NER metrics if reference text is provided
*Medicine Plan Excel ‚Äì if generated by the agent

### 9. Agent Actions on Plan
*The Plan section can be used to generate a medicine plan
*Optionally, send an appointment email by checking the consent checkbox
*Medicine plan Excel is downloadable if generated successfully



